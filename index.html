<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Script to play, manipulate and download YouTube videos" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <!-- generics -->
    <link rel="icon" href="images/favicon-32.png" sizes="32x32">
    <link rel="icon" href="images/favicon-96.png" sizes="96x96">
    <link rel="icon" href="images/favicon-128.png" sizes="128x128">
    <link rel="icon" href="images/favicon-192.png" sizes="192x192">

    <!-- iOS -->
    <link rel="apple-touch-icon" href="images/favicon-128.png" sizes="128x128">
    <link rel="apple-touch-icon" href="images/favicon-152.png" sizes="152x152">
    <link rel="apple-touch-icon" href="images/favicon-180.png" sizes="180x180">

    <!-- Windows 8 IE 10-->
    <meta name="msapplication-TileColor" content="#FFFFFF">
    <meta name="msapplication-TileImage" content="images/favicon-144.png">

    <!— Windows 8.1 + IE11 and above —>
    <meta name="msapplication-config" content="images/browserconfig.xml" />

    <meta name="msapplication-TileColor" content="#fefefe"/>
    <meta name="msapplication-square70x70logo" content="favicon-128.png"/>
    <meta name="msapplication-square150x150logo" content="favicon-270.png"/>
    <meta name="msapplication-TileImage" content="favicon-270.png"/>
    <meta name="msapplication-config" content="none"/>

    <title>Yt6 -- Snarl's YouTube Video Player</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/snarly/yt6">View on GitHub</a>

          <h1 id="project_title">Yt6</h1>
          <h2 id="project_tagline">Play back free of ads, tweak around with and download YouTube video & audio in almost any browser on both Desktop and Mobile</h2>

    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">

    <img style="position: absolute; left: 100%; height: 180px" src="images/screenshot01.jpg"></img>
    <img style="position: absolute; left: 100%; height: 180px; top: 231px" src="images/screenshot02.jpg"></img>
    <img style="position: absolute; left: 100%; height: 750px; top: 804px" src="images/screenshot03.jpg"></img>
    <img style="position: absolute; left: 100%; height: 180px; top: 422px" src="images/screenshot04.jpg"></img>
    <img style="position: absolute; left: 100%; height: 180px; top: 613px" src="images/screenshot05.jpg"></img>


	<h3>
	<a href="javascript:(function(){var v='23383e960ffb5bcdb8c4735169a4148e049c12c6/yt6.js',w=window,d=w.document,h=d.location.href,yt6=w.yt6||{},yt6d=w.yt6d||{};if(yt6d.loaded>=4)return void 0;if(h.split('youtube.com/watch')[1]||h.split('youtube.com/embed')[1]||h.split('/base.j')[1]=='s'){var id='snarls_player',e='script',q;yt6.loaded=0;function s(x){x=x||id;return d.getElementById(x)};function c(e){return d.createElement(e)};function a(q){s().appendChild(q);s().add_subs='en,hu,de';yt6d.src=q.src};function r(){if(s()){var x;try{x=s().querySelector('#'+id)}catch(e){x=s().firstChild};if(x)s().removeChild(x)}};function b(){var i,j,o,x;o=['.githack','git','js'];for(j,x,i=o.length;i;j=Math.floor(Math.random()*i),x=o[--i],o[i]=o[j],o[j]=x);if(yt6d.src!=1)o.splice(0,0,'.githubusercontent');q=c('div');q.id=id;if(q!=s())d.body.appendChild(q);var src='https://raw'+o[0]+'.com/snarly/yt6/'+v,src0='https://cdn.jsdelivr.net/gh/snarly/yt6@'+v;function oc(ox,oy,sr){return(oy!='js')?sr.replace(ox,oy):src0};q=c(e);q.id=id;q.src=(o[0]!='js')?src:src0;q.onerror=function(){q=c(e);q.id=id;q.src=oc(o[0],o[1],src);q.onerror=function(){q=c(e);q.id=id;q.src=oc(o[0],o[2],src);q.onerror=function(){q=c(e);q.id=id;q.src=oc(o[0],o[3],src);q.onerror=function(){q=c(e);q.id=id;q.src=src.replace('https','http')};a(q);r();};a(q);r();};a(q);r();};try{a(q);}catch(f){a(q)};};function g(){try{deldiv()}catch(f){r()};yt6d.src=1;b()};if(!s()){b()};setTimeout(function(){var t=w.yt6;if(t)t.loaded=t.loaded||window['status'];if(!t||(t&&(!t.body||(t.loaded<3))))g()},3000);}else{void 0};})()/*202101240630*/">Yt6 -- Snarl's YouTube Video Player (bookmarklet)</a>
	</h3>
	<h4>
		Last updated on Jan 24, 2021 06:20
	</h4>
		(Please check back from time to time to try the latest version, and if it works well, dump the 
older ones. It may be crucial regarding its functionality.)
	<h1>
		Features
	</h1>
		On any YouTube video (watch) page, this bookmarklet will call an external player and load 
		some extra functions, some of which can be used with YouTube's original player as well. 
		Written in pure javascript with the aim to be as much platform-independent and 
		backwards-compatible as possible. There is no installation, it works on-demand. Only a 
		working internet connection is needed. The program is able to

	<br>
	<ol>
		<li class="feat">restrict on-site advertisement,</li>
		<li class="feat">resize, zoom, rotate and move around video picture arbitrarily,</li>
		<li class="feat">select the desired media sequence to loop,</li>
		<li class="feat">change playback rate ("speed" or tempo) from 0 or 25% to up to 500 or 1600%,</li>
		<li class="feat">load an external audio file to play alongside the current video,</li>
		<li class="feat">pick your favoured (and supported) video/audio codec and resolution for playback,</li>
		<li class="feat">download the video/audio content,</li>
		<li class="feat">download subtitles/closed captions (CC)
		<ol>
		On bookmarklet line, you can edit the value 
		of "add_subs" after the equal sign and between apostrophes (a comma separated list 
		of ISO 639-1 languge codes, such as <code>'en, de, fr, es, jp'</code>...) to add Google-Translated tracks 
		of your choice,
		</ol>
		</li>
		<li class="feat">bypass age verification (only if video embedding is enabled by the content owner); 
		<ol>
		Examples: <a href="https://www.youtube.com/watch?v=07FYdnEawAQ)">Tunnel Vision (signatures encrypted)</a>, <a href="https://www.youtube.com/watch?v=UqPsrqpwLmU">Cobra (signatures unencrypted)</a><br>
		If you encounter videos like these on a playlist (while also being logged out or 
		ineligible to watch), the site's new layout will automatically throw you to the next 
		entry -- the script, however, will retain the age-restricted video's data and let you 
		continue to play it until it ends or you push the "next" button, upon which events the 
		video data for the current page should load,
		</ol>
		</li>
		<li class="feat">facilitate background play while your mobile is in sleep mode (experimental)</li>
		<li class="feat">change between YouTube layouts by setting the cookie on exit no longer works :( 
		<ol>
		YouTube stopped honoring the setting in July 2020 -- use a suitable browser 
		extension such as <div style="background-color: orange; display: inline-block">Good Old YouTube</div> (for <a href="https://addons.mozilla.org/en/firefox/addon/good-old-youtube/">Firefox</a> and <a href="https://chrome.google.com/webstore/detail/good-old-youtube/klkejolkjcefmocpgpjiefbpmgofahmh">Chrome</a>) or <div style="background-color: orange; display: inline-block">Old YouTube</div> (for <a href="https://addons.mozilla.org/en-US/firefox/addon/old-youtube/">Firefox</a>) if you want the 
		classic layout back.<br>
		Meanwhile, YT's spf js has also been deliberately deactivated, which means all 
		navigation on the old UI will now draw a full page refresh, making the site's -- not to 
		mention the script's -- usage feel thoroughly impractical and outdated. This issue can 
		be fixed though. More about it in the Classic YouTube layout fix section below.
		</ol>
		</li>
	</ol>
	<br>
		Keep in mind that this is not a browser extension. If anything, it's an extension of the 
		YouTube video page. Any event resulting in a browser page refresh -- such as leaving the 
		current YT subdomain, typing URLs directly to the address bar instead of following links, 
		or even just navigating between two points in your browsing history where a full page 
		refresh happened once already -- will cause the program code to be removed from 
		memory and you would need to reload it.
	<br><br>

	<h1>
		Setup
	</h1>

	<ol>
		<li>Right click / hold your finger on the Yt6 link above, and "Copy link address". If you 
		have no such option, the code is written below in plain text, select and copy it manually</li>
		<li>Bookmark any web page (this one for example)</li>
		<li>Edit the created bookmark's Properties / Location: delete its URL-address entirely, 
		and paste this snippet of javascript code in its place. (Optionally, you can give it a name 
		of your choice too.)</li>
		<li>Save the changes, if there is a Save button!</li>
	</ol>
		That's it, your bookmarklet is now ready to use.
	<br><br>
		Also, in many desktop browsers you can simply drag and drop the link to the Bookmarks 
		Toolbar, or right click on it and select "Bookmark this link".


	<br><br>
		Code in plain text:
	<br>
	<p>
	<code>
		javascript:(function(){var v='23383e960ffb5bcdb8c4735169a4148e049c12c6/yt6.js',w=window,d=w.document,h=d.location.href,yt6=w.yt6||{},yt6d=w.yt6d||{};if(yt6d.loaded>=4)return void 0;if(h.split('youtube.com/watch')[1]||h.split('youtube.com/embed')[1]||h.split('/base.j')[1]=='s'){var id='snarls_player',e='script',q;yt6.loaded=0;function s(x){x=x||id;return d.getElementById(x)};function c(e){return d.createElement(e)};function a(q){s().appendChild(q);s().add_subs='en,hu,de';yt6d.src=q.src};function r(){if(s()){var x;try{x=s().querySelector('#'+id)}catch(e){x=s().firstChild};if(x)s().removeChild(x)}};function b(){var i,j,o,x;o=['.githack','git','js'];for(j,x,i=o.length;i;j=Math.floor(Math.random()*i),x=o[--i],o[i]=o[j],o[j]=x);if(yt6d.src!=1)o.splice(0,0,'.githubusercontent');q=c('div');q.id=id;if(q!=s())d.body.appendChild(q);var src='https://raw'+o[0]+'.com/snarly/yt6/'+v,src0='https://cdn.jsdelivr.net/gh/snarly/yt6@'+v;function oc(ox,oy,sr){return(oy!='js')?sr.replace(ox,oy):src0};q=c(e);q.id=id;q.src=(o[0]!='js')?src:src0;q.onerror=function(){q=c(e);q.id=id;q.src=oc(o[0],o[1],src);q.onerror=function(){q=c(e);q.id=id;q.src=oc(o[0],o[2],src);q.onerror=function(){q=c(e);q.id=id;q.src=oc(o[0],o[3],src);q.onerror=function(){q=c(e);q.id=id;q.src=src.replace('https','http')};a(q);r();};a(q);r();};a(q);r();};try{a(q);}catch(f){a(q)};};function g(){try{deldiv()}catch(f){r()};yt6d.src=1;b()};if(!s()){b()};setTimeout(function(){var t=w.yt6;if(t)t.loaded=t.loaded||window['status'];if(!t||(t&&(!t.body||(t.loaded<3))))g()},3000);}else{void 0};})()/*202101240630*/
	</code>
	</p>
	<p>__</p>
	<h1>
		How to use
	</h1>
		<b><strong>On Desktop, just click on it on your bookmarks list</strong></b> whenever you enter a YouTube 
		video you want to play around with, unless you have the code already running.
	<br><br>
		<b><strong>On mobile, tap the browser's URL-address bar first </strong></b> (NOT the YouTube search bar!). 
		After that, the browser should suggest it as an available option once you start <b><strong>typing</strong></b> either 
		<b><strong>its name</strong></b> ("Yt6" or whatever you named it) or the prefix "javascript:" to narrow down the 
		search to bookmarklets only. <b><strong>Tapping on the correct entry</strong></b> shall initiate the call.
	<br><br>
		Automatic playback depends on the state of YouTube's own "Repeat / Loop Playlist" 
		button on user-created playlists. 
	<br><br>
		Use the HTML5 emblem on the control panel to switch between the native and this 
		alternative player.
	<br><br>
		It is also possible to use the bookmarklet code (minus the "javascript:" header) as a 
		<b><strong>userscript</strong></b> with addons like
	<ol>
		<div style="background-color:orange; display: inline-block">Greasemonkey</div> (for <a href="https://addons.mozilla.org/en-US/firefox/addon/greasemonkey/">Firefox</a>),<br>
		<div style="background-color:orange; display: inline-block">Tampermonkey</div> (for <a href="https://addons.mozilla.org/en-US/firefox/addon/tampermonkey/">Firefox</a>, <a href="https://chrome.google.com/webstore/detail/tampermonkey/dhdgffkkebhmkfjojejmpbldmpobfkfo">Chrome</a>, <a href="https://microsoftedge.microsoft.com/addons/detail/tampermonkey/iikmkjmpaadaobahmlepeloendndfphd">Edge</a> and <a href="https://addons.opera.com/hu/extensions/details/tampermonkey-beta/">Opera</a>) or <br>
		<div style="background-color:orange; display: inline-block">Violentmonkey</div> (for <a href="https://addons.mozilla.org/en-US/firefox/addon/violentmonkey/">Firefox</a>, <a href=" https://chrome.google.com/webstore/detail/violentmonkey/jinjaccalgkegednnccohejagnlnfdag">Chrome</a> and <a href="https://microsoftedge.microsoft.com/addons/detail/violentmonkey/eeagobfjdenkkddmbclomhiblgggliao">Edge</a>)<br>
	</ol>
	<ol style="font-size: 13px; display: none">
		<div style="color: red; display: inline-block">Notice:</div> Firefox is not the only browser affected by possible malfunction if the userscript finishes loading 
		before some important YouTube page elements could. I've added <b><strong>1000ms idle time</strong></b> before the call to the 
		main script. If your computer is too slow, you can up the value.<br>
	</ol>

<pre>// ==UserScript==
// @name         Yt6 -- Snarl's YouTube Video Player (userscript)
// @namespace    yt6
// @version      202101240630
// @author       Snarl
// @description  Auto-Load Yt6 script as soon as possible
// @match        https://*.youtube.com/watch*
// @match        https://*.youtube.com/embed/*
// @match        http://*.youtube.com/watch*
// @match        http://*.youtube.com/embed/*
// @grant        none
// @run-at       document-end
// @icon         https://yt3.ggpht.com/-afBnHVG_R6E/AAAAAAAAAAI/AAAAAAAAAAA/LtE5kbPkZvE/s27-c-k-no-mo-rj-c0xffffff/photo.jpg
// ==/UserScript==

(function(){

  window['yt6'] = {}; window['yt6d'] = {}; window['yt6'].body = 1

  var idle_time = 1000 // wait some time before running the bookmarklet part

  var onComplete = function(){setTimeout( //javascript:(
    function(){var v='23383e960ffb5bcdb8c4735169a4148e049c12c6/yt6.js',w=window,d=w.document,h=d.location.href,yt6=w.yt6||{},yt6d=w.yt6d||{};if(yt6d.loaded>=4)return void 0;if(h.split('youtube.com/watch')[1]||h.split('youtube.com/embed')[1]||h.split('/base.j')[1]=='s'){var id='snarls_player',e='script',q;yt6.loaded=0;function s(x){x=x||id;return d.getElementById(x)};function c(e){return d.createElement(e)};function a(q){s().appendChild(q);s().add_subs='en,hu,de';yt6d.src=q.src};function r(){if(s()){var x;try{x=s().querySelector('#'+id)}catch(e){x=s().firstChild};if(x)s().removeChild(x)}};function b(){var i,j,o,x;o=['.githack','git','js'];for(j,x,i=o.length;i;j=Math.floor(Math.random()*i),x=o[--i],o[i]=o[j],o[j]=x);if(yt6d.src!=1)o.splice(0,0,'.githubusercontent');q=c('div');q.id=id;if(q!=s())d.body.appendChild(q);var src='https://raw'+o[0]+'.com/snarly/yt6/'+v,src0='https://cdn.jsdelivr.net/gh/snarly/yt6@'+v;function oc(ox,oy,sr){return(oy!='js')?sr.replace(ox,oy):src0};q=c(e);q.id=id;q.src=(o[0]!='js')?src:src0;q.onerror=function(){q=c(e);q.id=id;q.src=oc(o[0],o[1],src);q.onerror=function(){q=c(e);q.id=id;q.src=oc(o[0],o[2],src);q.onerror=function(){q=c(e);q.id=id;q.src=oc(o[0],o[3],src);q.onerror=function(){q=c(e);q.id=id;q.src=src.replace('https','http')};a(q);r();};a(q);r();};a(q);r();};try{a(q);}catch(f){a(q)};};function g(){try{deldiv()}catch(f){r()};yt6d.src=1;b()};if(!s()){b()};setTimeout(function(){var t=w.yt6;if(t)t.loaded=t.loaded||window['status'];if(!t||(t&&(!t.body||(t.loaded<3))))g()},3000);}else{void 0};}
    //)()/*202101240630*/
  , idle_time)
  }

  var check = function(){ // conditions to meet before loading
    var x = window['performance'];
    if (x && x.timing && x.timing.loadEventEnd > 0 && x.timing.loadEventEnd >= x.timing.domComplete) return true
  }

  if (check()) {
      onComplete()
      return
  }

  var delay = 500, timeout = 8000

  var timeoutPointer
  var intervalPointer = setInterval(function () {
      if (!check()) return

      clearInterval(intervalPointer)
      if (timeoutPointer) clearTimeout(timeoutPointer)
      if (typeof onComplete == 'function') onComplete()
  },delay)

  if (timeout) timeoutPointer=setTimeout(function () {
      clearInterval(intervalPointer)
  },timeout)

})()</pre>
	<br><br>

	<h1>
		Background play on Mobile
	</h1>
		You won't have to request YouTube's resource-hungry Desktop mode to be able to listen 
		to videos over a locked screen -- the site's lightweight Mobile version will do just fine. Use 
		the 48k Opus audio-only format for playback to save as much power as possible. (The 
		drop in sound quality rarely becomes noticeable.) Beside the fact that picking a video 
		format for background play is pretty much pointless as you can't see it over the locked 
		screen, it would also raise the chance of playback failure significanty. There are some 
		browsers which don't like playing audio on its own that much though.
	<br><br>
		Drawbacks: the jump forward button on the locked screen's media control panel will never 
		work (by design, because they do not want you to use their site for continuous background 
		play on mobile). Plus, since there is no way to view age-restricted videos on 
		this UI without being logged in, you would have to manually skip those after you unlocked 
		the screen.
	<br><br>
		The media controls over the screen lock provide real access to the original player only. 
		When the alternative player is the active one, the panel's play button is merely able to 
		kickstart it, but can't pause it or seek forward or backward on its time rail.

	<br><br>
	<h1>
		Supported browsers
	</h1>
		<b><strong>On Desktop</strong></b>, the script should work with almost any browser now. The only criteria is that 
		they must support the usage of bookmarklets, which most of them do.
	<br><br>
		Below is a ranking of popular <b><strong>Mobile browsers</strong></b> based on how well they work under the 
		following conditions
<ol>
		- using the script's alternative player<br>
		- on YouTube's mobile interface (m.youtube.com domain)<br>
		- while the device is in actual sleep mode (screen turned off and with no connection to 
		any external power source through cable)<br>
</ol>
	<ol><p>
	<h5>
		Good ones (for Android)
	</h5>
		<li><a href="https://play.google.com/store/apps/details?id=com.vivaldi.browser">Vivaldi</a>
		<li><a href="https://play.google.com/store/apps/details?id=com.brave.browser">Brave</a>
		<li>Google Chrome
	<h5>
		So-so
	</h5>
		<li><a href="https://play.google.com/store/apps/details?id=com.kiwibrowser.browser">Kiwi</a> (performs well in incognito mode only. where it has its extensions disabled)
		<li><a href="https://play.google.com/store/apps/details?id=com.yandex.browser">Yandex</a> (will break its own sound output until a page refresh if audio-only or legacy AV format is being used for playback -- use VP9 or DASH video instead)
	<h5>
		Bad ones (will play max 3-4 videos in a row)
	</h5>
		<li><a href="https://play.google.com/store/apps/details?id=com.opera.browser">Opera</a>
		<li><a href="https://play.google.com/store/apps/details?id=com.microsoft.emmx">Edge</a>
		<li>Epic
		<li>Dolphin
		<li>Firefox</strong></b> (version <a href="https://www.apkmirror.com/apk/mozilla/firefox/firefox-68-11-0-release/">68.11.0</a> only, the newer one doesn't even support bookmarklets anymore)
	</ol></li>
		
	</p></ol>
		Of course it's possible to rank them differently with other aspects or conditions in mind.
	<br><br>
		Useless to go into detail as to how one is better than the other. Their performance 
		changes with every system-, application- or script-update, and it's difficult to pinpoint the 
		cause of a problem newly arisen or seemingly solved. The list reflects a general 
		impression after about half a year of testing on an Android phone.

	<br><br>
		Regardless of platform, the default "noname" browsers that come pre-installed on various 
		systems typically have no support for bookmarklets. If your chosen browser's response to 
		your attempt to use the bookmarklet is to pull a web search on words found on the 
		bookmarklet line, it is safe to say that it doesn't support it.

	<br><br>
	<h1>
		Legacy browsers
	</h1>
		Till June/July of 2020 the bookmarklet was usable with really old browsers too that were 
		dated back to around the IE7/8 era (with the help of the Adobe Flash plugin), but now that 
		YouTube enforces its bug-filled new layout, they broke compatibility with them.
	<br><br>
		Still, I found a way to make use of this script with outdated browsers anyway.<br>
		It's obviously discouraged now to use them because of the myriad of security holes	that 
		can be found in such old sowftware, not to mention that the development of Adobe Flash 
		will also end officially in 2020. But in case you have no other option, the possibility is 
		there.
	<br><br>
		The trick is to visit the "embed" page which contains a stripped-down code normally used 
		to create an embedded video on other websites. There is literally nothing on these pages 
		beside the player itself, therefore it's super lightweight which makes it a legit choice even 
		for modern browsers (if you just want simple playback in the background). It's clunky and 
		inconvenient to use on mobile, not recommended there. On desktop, it's okay.
	<br><br>
		Regular video URL with playlist<br>
	<code>https://www.youtube.com/<b><strong><div style="color: red; display: inline-block">watch?v=</div></strong></b>BJPKUw8QIlk<b><strong><div style="color: red; display: inline-block">&</div></strong></b>list=PLXlj3dvMsYiLWcmENQsUHEQr8Snw1PH3X&index=1022</code>
<br><br>
		The "embed" variant to enter on the address bar<br>
	<code>https://www.youtube.com/<b><strong><div style="color: red; display: inline-block">embed/</div></strong></b>BJPKUw8QIlk<b><strong><div style="color: red; display: inline-block">?</div></strong></b>list=PLXlj3dvMsYiLWcmENQsUHEQr8Snw1PH3X&index=1022</code>

	<br><br>
		Then you just load the script like you would on a watch page.
	<br><br>
		There is one caveat though.
	<br><br>
		YouTube has recently begun to test the browser's <b><strong>User-Agent string</strong></b> more thoroughly 
		to determine whether to grant access to content or not. If access was denied, no media urls 
		will be available for playback. So if YT doesn't like your UA, you will have no choice but to 
		modify or spoof it.
	<br>
	<u><h4>Mobile specific</h4></u>
	<ol>
		The following parts of a mobile UA trigger sites to show their mobile interface, and in 
		case of the YT embed page, block script-access.
	<br><br>
		 <code style="color: red">Linux; Android</code><br>
		 <code style="color: red">Android</code> [...] <code style="color: red">Mobile</code><br>
		 <code style="color: red">iPhone; CPU; iPhone</code> [...] <code style="color: red">Mobile</code><br>
		 <code style="color: red">iPad; CPU</code> [...] <code style="color: red">Mobile</code></code>
	<br><br>
		The "Request Desktop version" option in mobile browsers does in effect replace the 
		mobile UA with a hardcoded Desktop UA. So turn that on before you visit an embed 
		page on mobile.
	</ol>
	<u><h4>Useful addons</h4></u>
	<ol>
	<div style="background-color: orange; color: black; display: inline-block">User-Agent Switcher and Manager</div> for <a href="https://addons.mozilla.org/en-US/firefox/addon/user-agent-string-switcher/">Firefox</a>, <a href="https://chrome.google.com/webstore/detail/user-agent-switcher-and-m/bhchdcejhohfmigjafbampogmaanbfkg">Chrome</a>, <a href="https://microsoftedge.microsoft.com/addons/detail/useragent-switcher-and-m/cnjkedgepfdpdbnepgmajmmjdjkjnifa">Edge</a> and <a href="https://addons.opera.com/hu/extensions/details/user-agent-switcher-8/">Opera</a><br>
	Alternative: <div style="background-color: orange; color: black; display: inline-block">User-Agent Switcher</div> for <a href="https://addons.mozilla.org/en-US/firefox/addon/uaswitcher/">Firefox</a>, and <a href="https://microsoftedge.microsoft.com/addons/detail/useragent-switcher/npjnioaeoicmjokbdpfiecnbildopjad">MS Edge Canary</a>
	</ol>
	In Firefox-variants, you can try using the internal configuration page <b><strong>about:config</strong></b> and 
	add, or if it exists, edit, the preference key <code>general.useragent.override</code> by giving it the 
	chosen User-Agent string.
	<br><br>
	Below are some working examples. Text in blue are recommended values.
	<u><h4>User Agent strings</h4></u>
	<u><h4>Firefox</h4></u>
	<ol>
		<h6>Windows</h6><code>Mozilla/5.0 (Windows NT <b style="color: blue; display: inline-block">10.0</b>; Win64; x64; rv:<b style="color: blue; display: inline-block">83.0</b>) Gecko/20100101 Firefox/<div style="color: blue; display: inline-block">83.0</div></code>
		<h6>Linux</h6><code>Mozilla/5.0 (X11; Linux x86_64; en-us; rv:<b style="color: blue; display: inline-block">83.0</b>) Gecko/20100101 Firefox/<b style="color: blue; display: inline-block">83.0</b></code>
		<h6>Mac OS X</h6><code>Mozilla/5.0 (Macintosh; Intel Mac OS X <b style="color: blue; display: inline-block">10.16.1</b>; rv:<b style="color: blue; display: inline-block">83.0</b>) Gecko/20100101 Firefox/<b style="color: blue; display: inline-block">83.0</b></code>
	</ol>
	<u><h4>Chrome</h4></u>
	<ol>
		<h6 style="display: inline-block">Windows</h6><br><code>Mozilla/5.0 (Windows NT <b style="color: blue; display: inline-block">10.0</b>; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/<b style="color: blue; display: inline-block">85.0.4183.83</b> Safari/537.36</code><br>or<br><code>Mozilla/5.0 (Windows NT <b style="color: blue; display: inline-block">6.1</b>; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/<b style="color: blue; display: inline-block">80.0.3987.122</b> Safari/537.36</code>
		<div><h6>Linux</h6>
		<code>Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/<b style="color: blue; display: inline-block">86.0.4240.111</b> Safari/537.36</code></div>
		<div><h6 style="display: inline-block">Mac OS X</h6><br>
		<code>Mozilla/5.0 (Macintosh; Intel Mac OS X <b style="color: blue; display: inline-block">10_14_4</b>) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/<b style="color: blue; display: inline-block">99.0.3538.77</b> Safari/537.36</code>
		</div>
	</ol>
	<u><h4>Edge</h4></u>
	<ol>
		<div><h6 style="display: inline-block">Windows</h6><br><code>Mozilla/5.0 (Windows NT <b style="color: blue; display: inline-block">10.0</b>; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/<b style="color: blue; display: inline-block">81.0.4044.0</b> Safari/537.36 <b style="color: blue; display: inline-block">Edg/86.0.597.0</b></code><br>or<br><code>Mozilla/5.0 (Windows NT <b style="color: blue; display: inline-block">6.1</b>; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/<b style="color: blue; display: inline-block">81.0.4044.0</b> Safari/537.36 <b style="color: blue; display: inline-block">Edge/12.10240</b></code></div>
		<div><h6 style="display: inline-block">Linux</h6><br><code>Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/<b style="color: blue; display: inline-block">81.0.4044.0</b> Safari/537.36 <b style="color: blue; display: inline-block">Edg/88.0.705.9</b></code></div>
		<div><h6 style="display: inline-block">Mac OS X</h6><br><code>Mozilla/5.0 (Macintosh; Intel Mac OS X <b style="color: blue; display: inline-block">10_16_2</b>) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/<b style="color: blue; display: inline-block">82.0.4085.0</b> Safari/537.36 <b style="color: blue; display: inline-block">Edg/84.0.522.15</b></code>
	</ol>
	<u><h4>Opera</h4></u>
	<ol>
		Any part of the UA revealing Opera will result in automatic denial when trying to access 
		the media on the embed page. So we need to obfuscate those:<br>
		<code style="color: red">OPR/</code> --> <code>OP/</code> or <code style="color: red">Opera</code> --> <code>Oper</code><br>
		<div><h6 style="display: inline-block">Windows</h6><br><code>Mozilla/5.0 (Windows NT <b style="color: blue; display: inline-block">10.0</b>; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/<b style="color: blue; display: inline-block">86.0.4240.111</b> Safari/537.36 OP/<b style="color: blue; display: inline-block">71.0.3770.97</b></code></div>
		<div><h6 style="display: inline-block">Linux</h6><br>
		<code>Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/<b style="color: blue; display: inline-block">86.0.4240.111</b> Safari/537.36 OP/<b style="color: blue; display: inline-block">71.0.3770.97</b></code></div>
		<div><h6 style="display: inline-block">Mac OS X</h6><br><code>Mozilla/5.0 (Macintosh; Intel Mac OS X <b style="color: blue; display: inline-block">10_12_6</b>) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/<b style="color: blue; display: inline-block">80.0.3987.122</b> Safari/537.36 OP/<b style="color: blue; display: inline-block">67.0.3575.53</b></code></div>
	</ol>
	<u><h4>Yandex</h4></u>
	<ol>
		<div><h6 style="display: inline-block">Windows</h6><br><code>Mozilla/5.0 (Windows NT <b style="color: blue; display: inline-block">6.3</b>; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/<b style="color: blue; display: inline-block">78.0.3904.97</b> YaBrowser/19.12.0.769 Yowser/2.5 Safari/537.36</code></div>
		<div><h6 style="display: inline-block">Linux</h6><br><code>Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/<b style="color: blue; display: inline-block">80.0.3987.122</b> YaBrowser/19.12.0.769 Yowser/2.5 Safari/537.36</code></div>
		<div><h6 style="display: inline-block">Mac OS X</h6><br><code>Mozilla/5.0 (Macintosh; Intel Mac OS X <b style="color: blue; display: inline-block">10_14_6</b>) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/<b style="color: blue; display: inline-block">78.0.3904.97</b> YaBrowser/19.12.0.769 Yowser/2.5 Safari/537.36</code></div>
	</ol><br>
		<b><strong>Pro:</strong></b> the alternative player can play videos which are otherwise blocked from view 
		in embedded frames.<br>
		<b><strong>Con:</strong></b> due to a YT limitation, you can only access the first 200 videos on an "embed" 
		playlist. The example above is the 1023th entry (indexed 1022) on the list, and it will load 
		fine. But once you try to navigate, there will be no way to watch anything above index 199.
	<br><br>
	<h1>
		Classic YouTube layout fix
	</h1>
		Installing one of the <div style="background-color: orange; display: inline-block">(Good) Old YouTube</div> addons may not be enough. 
	<br><br>
		Actually, at the time of this update (Dec 11, 2020), neither of them seem to work anymore. 
		Which could very well mean the almighty gods of YT may have ordered to pull the plug on 
		the Classic layout once and for all, and no fix will bring it back anymore, so anything 
		beyond this could be considered obsolete now regarding the Classic layout.
	<br><br>
		YouTube has increasingly become more and more picky and restrictive about <b><strong>User-Agent strings</strong></b> 
		in the latter half of 2020.
	<br><br>
		A well known error symptom is when a small and useless text file called <b><strong>json.txt</strong></b> is served 
		for download instead of displaying the actual page in the old layout. It may indicate that 
		the site "doesn't like" your browser's current User-Agent string -- may it be the original one 
		or one spoofed by an extension or a Firefox-veriant's built-in related setting such as<br>
		<code>general.useragent.override</code><br>
		or<br>
		<code>privacy.resistFingerprinting</code><br>
	<ol style="font-size: 13px">
		(This latter, boolean-type key makes the browser report a hardcoded UA, reduce identifying data sent out, 
		restrict userscript functioality, etc. But can also break sites which would rely on that suppressed data.)
	</ol>
		Just a few weeks ago, if the old layout was broken with the json.txt error, it could be fixed 
		by manually adding the word <b><strong>Googlebot</strong></b> to the UA. Trying to do the same thing now will 
		break the layout for sure.
	<br><br>
		The User-Agent strings that I have collected to make the embed page work (listed in the 
		previous section) seemed to work for the old layout too (until Dec 11). You could pick any 
		one of them, copy it to the input field of your chosen User-Agent spoofer, apply the 
		change, refresh the page, and the json.txt problem would be gone with the Classic layout 
		ready to use.
	<br><br>
		As for the Yt spf issue mentioned earlier, I've created a userscript which reinstates the 
		polyfill. (Userscripts can be used with addons like <div style="background-color: orange; display: inline-block">Grease-, Tamper-, Violentmonkey</div>) 
		Since this task must be done very early in the webpage parsing process, it cannot be 
		accomplished as part of the Yt6 script.
	<br><br>
		The point of the Yt spf polyfill was to merely update differing parts of old-style YT pages 
		when navigation happened. Unfortunately, if you're logged in over the Classic layout, YT is 
		now forcing a full page refresh on every page, no matter what, so the only way to see the 
		benefits of YT spf is to stay logged out of YouTube.
	<br><br>
		Here is the userscript:<br>
<pre>// ==UserScript==
// @name         Yt spf
// @namespace    Yt spf
// @version      202012110714
// @author       Snarl
// @description  Use spf-based navigation on Classic YouTube
// @match        https://*.youtube.com/*
// @match        http://*.youtube.com/*
// @grant        none
// @run-at       document-start
// @icon         https://yt3.ggpht.com/-afBnHVG_R6E/AAAAAAAAAAI/AAAAAAAAAAA/LtE5kbPkZvE/s27-c-k-no-mo-rj-c0xffffff/photo.jpg
// ==/UserScript==

(function() {
		'use strict';

		var d = window.document
		// earliest stage of loading the yt page
		if (d.readyState == 'loading' && !(typeof ytspf != 'undefined' && ytspf.enabled == true) && typeof Proxy == 'function') {

				var s = d.createElement('script')
				s.id = 'ytspf'
				var h = d.lastChild.firstChild // <head> element already exists

				// code to define the ytspf object as it once used to be, before the new yt code has a chance to do it differently
				var code = "var ytspf = {};ytspf.enabled = true;ytspf.config = {'reload-identifier': 'spfreload'};ytspf.config['request-headers'] = {'X-YouTube-Ad-Signals': {toString: function() {return (window['yt'] && yt['ads_'] && yt.ads_['signals_'] &&yt.ads_.signals_['getAdSignalsString']) ?yt.ads_.signals_.getAdSignalsString() :'';}},'X-YouTube-Identity-Token': null};ytspf.config['experimental-request-headers'] = ytspf.config['request-headers'];ytspf.config['cache-max'] = 50;ytspf.config['navigate-limit'] = 50;ytspf.config['navigate-lifetime'] = 64800000;"

				// then wrap the ytspf object around a proxy of the same name with a "set"-trap to deny the re-definition attempt by yt
				code = code + "ytspf = new Proxy(ytspf, { set(target, prop, val) { return false } });"

				if (h.lastChild.previousSibling && (typeof h.lastChild.previousSibling.getAttribute != 'function' || h.lastChild.previousSibling.toString() == '[object Text]'))
				// append the script element to the document head
				try {
					s.appendChild(document.createTextNode(code))
					h.appendChild(s)
				} catch (e) {
						try {
							s.text = code
							h.appendChild(s)
						} catch (e) {}
					}

		}
})()</pre>
	<br>
	<h1>
		Stream capturing
	</h1>
		The yt6 script can expose URLs in the sourcechooser / download box which doesn't seem 
		to work -- there is no way to load them for playback, and trying to download the linked 
		content would either result in a zero-length file or merely a short segment of a live stream.
	<br><br>
		That's because there is no contiguous media file behind those links. Only fragments of 
		media -- hardly usable in the old-fashioned way -- meant to be streamed by a player 
		capable of streaming. You can recognize these URLs as video- or audio-only sources 
		which have no file size displayed next to them. Since a recent update of the yt6 
		code, along with the stream URLs appears a link to a "DASH Manifest" also, and in case of 
		live streams, a "HLS Manifest" too, which are XML documents containing info on 
		the streamable bits.
	<br><br>
		Here is one example of the <a href="https://www.youtube.com/watch?v=ile8wMQOsMY">"yt_otf"</a> type.
	<ol><div style="font-size: 13px">
		(YouTube may occassionally replace the stream URLs with traditional media URLs. Typically happens when 
		a video reaches a certain level of popularity.)
	</div></ol>
		And here is the <a href="https://www.youtube.com/watch?v=f0cGgOv3l4c">"yt_live_broadcast"</a> type.
	<br><br> 
		I wrote a small <b><strong>bash shell script</strong></b> called <code style="background-color: yellow; color: red">yt_streamcat</code> which makes it possible to save 
		the media behind those type of URLs as well. It's a Command Line Interface (CLI) utility  
		which relies on a widely used binary program called <b><strong>wget</strong></b> to be installed on the system. 
		Having <b><strong>ffmpeg</strong></b>, the "swiss army knife of Internet Streaming" installed is a huge bonus, but 
		is only truly required for reconstructing MPEG-DASH live streams into playable singular 
		files. (And in case ffmpeg produces broken media, you may need an alternative tool 
		capable of media muxing, such as <b><strong>mencoder</strong></b>, to process the ffmpeg-produced file 
		and fix it for good.)
	<br><br>
		The script is supplementary code to do the job which is not possible for the yt6 main 
		program in a javascript environment. Save the program file (link below) to an accessible 
		subfolder on your computer -- preferably a dedicated folder you don't mind getting filled up 
		with temporary media file segments -- open a virtual terminal (with a bash shell running on 
		it) and change working directory ("cd" in)to that folder.
	<br><br>
		Currently, the script has only a <a href="/yt6/yt_streamcat">Linux version</a> available, but it shouldn't be too hard to port 
		it to Windows.
	<br><br>
		Under Linux, newly created or downloaded files cannot be run by default, regardless of 
		whether they are meant to be executables or not. Technically speaking they are not 
		getting marked as executable, for security reasons. In order to make a file executable for 
		your own user only, you must run the following command at the shell prompt:<br>
	<code>chmod u+x [path to file/]filename</code>

	<br><br>
		The script command itself must be issued the following way:
	<br>
<pre>./yt_streamcat target_file "stream_base_URL" start end "2nd_stream_URL"</pre>
	<br>
		where
	<br><ol>
		<code>./</code> means the program file is located in the current directory (in Windows, <code>.\</code> would 
			mean the same thing)<br>
		<code>yt_streamcat</code>
			<ol>is the script file we run as our command</ol>
		<code>target_file</code> (mandatory)
			<ol>is a user-specified file the media segments are going to be written into -- must not 
			exist yet, if it does, the script will abort to prevent an accidental overwrite</ol>
		<code>"stream_base_URL"</code> (mandatory)
			<ol>is a YT stream source URL originating from one of the two possible types of videos 
			mentioned above, extracted by the yt6 main program. Must be enclosed in quotation 
			marks to prevent bash from misinterpreting each URL-parameter (after each "&" 
			sign) as yet another command to run in the background.</ol>
		<code>start</code> (optional)
			<ol>is the number of the segment the media should begin download from. For live 
			streams, you should give this a value somewhere between the first and last 
			available "sq" (segment query?) parameter values which you can read on the DASH and HLS 
			Manifest URL lines. If you go over that range, the download will start with the 
			most recent live segment. If you go below it, the download will stall.</ol>
		<code>end</code> (optional)
			<ol>is the number of the ending segment, or if it's less than the previous number, it will 
			be interpreted as the number of segments to download</ol>
		<code>"2nd_stream_URL"</code> (optional)
			<ol>to save another track parallel to the first one (the audio source, maybe?). Must be 
			between quotes as well. (You must specify the previous two options in order to be 
			able to specify this fifth one.)</ol>
	<br>
		It is easier to write a wrapper script to handle the program rather than always have to 
		type out the whole command line yourself. Then just edit the part which needs to be 
		changed. The wrapper should look like something like this:
	<pre>#!/bin/bash

./yt_streamcat v "https://[...]googlevideo.com/videoplayback?[...]" 100 150 \
"https://[...]googlevideo.com/videoplayback?[...]"
	</pre>
	<br>
		where the target file will be "v" (thus the secondary source will be saved to "vA"), 
		number 100 is going to be the first segment to be saved and 150 will be the last. Notice 
		the <code>\</code> character, which is the escape character in most programming languages. 
		It escapes a line break inside the wrapper for the lines before and after it which bash 
		is supposed to interpret as a single line of command. (No other character must be present 
		between the escape character and the following invisible newline character.) You can 
		name the wrapper file anything you want, just make it executable the same way as 
		above, then enter <code>./[wrapper_filename]</code>, and it will run the command(s) inside of it. 
	<br><br>
		One way to abort a running bash script process is to hit Ctrl+C on the terminal. A 
		temporary helper script is always generated automatically for such events to take care 
		of the remaining minimum steps in the muxing procedure. Its default filename is 
		<code>0[target_filename]-yt_streamcat-ffmpeg</code>, you just have to execute 
		it.
	<br><br>
		In my tests, live-streamed <b><strong>webm</strong></b> video content seemingly encoded as <b><strong>30fps</strong></b>, had 
		to be regularly remuxed to a framerate of anywhere between <b><strong>36 and 36.25fps</strong></b> in the saved 
		file, then also remove one segment from the beginning in order to get it synced up with 
		the audio track. No idea why that is the case, but it is. For higher framerates, the 
		difference should be even larger.
	<br><br>
	<h6>
		Remuxing commandline examples:
	</h6>
		To fix a broken mp4
	<pre>mencoder v.mp4 -ovc copy -o v2.mp4</pre>
		To change the framerate of a webm from 30 to 36
	<pre>mencoder v.webm -ovc copy -mc 0 -noskip -fps 30 -ofps 36 -o v2.webm</pre>
		To cut the first video segment out, mencoder's seek option must be a bit less than each 
		segment's duration, so if they are 5 seconds long, 4 seconds will do
	<pre>mencoder v2.webm -ovc copy -ss 4 -o v3.webm</pre>
		Finally, to mux the video and audio into one matroska file
	<pre>ffmpeg -i v3.webm -i vA.aac -c:v copy -c:a copy v.mkv</pre>
		Check if the mkv is playable, then remove the intermediate files.

	<p>__</p>
	<br>
		Credit should go to the authors of their respective open source code I had my own built around:
	<br>
	<h3>
		John Dyer - Mediaelementplayer - <a href="http://mediaelementjs.com/">http://mediaelementjs.com/</a><br>
		Christian Heilmann - Transformvideo - <a href="http://github.com/codepo8/rotatezoomHTML5video">http://github.com/codepo8/rotatezoomHTML5video</a><br>
		Steven Penny - Youtube download bookmarklet - <a href="http://svnpenn.github.io/bm/">(closed account)</a><br>
	</h3>
	<br>
		This program is free to use for anyone.<br>
		But if you would like to, you can tip me anonymously through an option included.
	</p>


	<p>__</p>


	<h1>
		Important Notes
	</h1>

	<br>
	<ol>
	<li>
	<p>
		If you use add-ons like NoScript (a recommended practice), make sure to
	<h5>
		Whitelist / Trust these domains permanently:
	</h5>

		githubusercontent.com - program code is stored on this site<br>
		<a href="https://rawgit.com">rawgit.com</a> - #1 proxy to load the files<br>
		<a href="https://raw.githack.com">githack.com</a> - #2<br>
		<a href="https://www.jsdelivr.com/">jsdelivr.net</a> - #3<br>
		<!--a href="https://allow-any-origin.appspot.com">allow-any-origin.appspot.com</a> - #1 proxy to get the video signature decryption data<br-->
		<a href="https://cors-anywhere.herokuapp.com">cors-anywhere.herokuapp.com</a> - (not necessary for some time now)<br>
		<a href="https://www.youtube.com">youtube.com</a> - won't even budge without its own javascript code running<br>
		googlevideo.com - youtube media is delivered through this domain<br>
	</p>
	</li>
	<br>
	<li>
	<p>
		The alternative player of Yt6 uses the Progressive Download method to access video & 
		audio, instead of the Adaptive Streaming YouTube's own player had as the default 
		since late 2013.
	<br><br>

		Both have their pros and cons. With the former, media is getting piled up in the browser's 
		cache during playback, which means there must be enough free space for storage either
		in the system RAM or on the disk. While in the case of streaming, you 
		only have tiny slices of the media buffered at all times, which in turn requires higher 
		CPU-power and constantly fast network speeds.
	<br>
		Consequently, for live streams or Ultra-HD videos it's recommended to switch over to 
		YouTube's native player, as it is much better suited for those.
	
	<br><br>
		To make sure your browser chooses memory over the much slower and/or fragile Hard 
		Disk / Solid-state drive for temporary storage, <strong><b>use the program in an Incognito / 
		In-private browser window or tab.</b></strong>
	</p>
	</li>
	<br>
	<li>
	<p>
		Occasionally, some age-restricted videos may get the same subdomain for their 
		source location as known YouTube video commercials which have already been 
		registered with adblockers such as uBlock Origin or Brave Browser's ad-shield, and as 
		a result, their download links will be made inaccessible by these adblockers as well. 
		Except if<br>
	<p>
	<ol>
		<li>you are logged in to an eligible YouTube account</li>
		<li>don't use ad-blockers at all</li>
		<li>or set up exceptions in the ad-blocker's settings</li>
	</ol>
	</p>
		For example, on uBlock Origin's control panel, the explicit greenlighting of the domains
	<br><br>
		youtube.com -- for the player data and<br>
		googlevideo.com -- to access the media links<br>
	<br>
		will do the trick, although this way you may end up getting some video ads too.<br>
		(You first need to activate the Advanced User mode in uBlock Origin's settings menu to 
		be able to do this. Tutorial: <a href="https://www.youtube.com/watch?v=SIYcI2tEqo8">https://www.youtube.com/watch?v=SIYcI2tEqo8</a>)
	<br>
	</p>
	</li>
	</ol>
	<br>


      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Yt6 maintained by <a href="https://github.com/snarly">Snarl</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
